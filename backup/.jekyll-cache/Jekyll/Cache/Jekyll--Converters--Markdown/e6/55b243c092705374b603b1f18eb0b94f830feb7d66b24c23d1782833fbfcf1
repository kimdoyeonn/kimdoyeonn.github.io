I"L4<p>출처: <a href="https://docs.djangoproject.com/ko/3.1/intro/tutorial01/">첫번째 장고앱 작성하기</a></p>

<p>간단한 설문조사 어플리케이션 만들기</p>

<ul>
  <li>사람들이 설문 내용을 보고 직접 투표할 수 있는 개방된 사이트</li>
  <li>관리자가 설문을 추가, 변경, 삭제할 수 있는 관리용 사이트</li>
</ul>

<h4 id="django-설치되어있는지-버전-확인하기">django 설치되어있는지, 버전 확인하기</h4>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span><span class="w"> </span><span class="nf">python</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nx">django</span><span class="w"> </span><span class="nt">--version</span><span class="w">
</span></code></pre></div></div>

<h3 id="프로젝트-만들기">프로젝트 만들기</h3>

<p>Django를 처음 사용한다면 초기 설정에 주의를 기울여야한다. Django project를 구성하는 코드를 자동으로 생성해야 하는데, 이 과정에서 데이터베이스 설정, Django를 위한 옵션들, 어플리케이션을 위한 설정들과 같은 Django 인스턴스를 구성하는 수많은 설정들이 생성되기 때문입니다.</p>

<ul>
  <li>
    <p>커맨드라인에서 cd 명령어로 코드를 저장할 디렉터리로 이동 후 다음의 명령을 수행</p>

    <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span><span class="w"> </span><span class="nf">django-admin</span><span class="w"> </span><span class="nx">startproject</span><span class="w"> </span><span class="nx">mysite</span><span class="w">
</span></code></pre></div>    </div>

    <p>이 명령은 현재 디렉토리에 mysite라는 디렉토리를 생성할 것입니다.</p>

    <blockquote>
      <p>프로젝트를 생성할 때는 Python 또는 Django에서 사용 중인 이름은 피해야합니다. 예를 들어 django(Django와 충돌), test(Python 패키지 이름 중 하나) 같은 이름</p>
    </blockquote>

    <blockquote>
      <p>작성한 코드는 DocumentRoot의 바깥에 두는 것을 추천합니다. 웹서버의 DocumentRoot에 존재할 경우 웹을 통해 외부의 사람들이 Python 코드를 직접 열어볼 수 있는 위험이 있기 때문에 보안에 좋지 않습니다.</p>
    </blockquote>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">startproject</code>에서 생성되는 것</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysite/
	manage.py
	mysite/
		__init__.py
		settings.py
		urls.py
		asgi.py
		wsgi.py
</code></pre></div>    </div>

    <ul>
      <li>바깥 mysite 폴더는 프로젝트를 위한 공간으로 이것의 이름은 Django와 상관이 없습니다. 아무거나 원하는 이름으로 변경해도 됩니다.</li>
      <li><code class="language-plaintext highlighter-rouge">manage.py</code> Django 프로젝트와 다양한 방법으로 상호작용하는 커맨드라인의 유틸리티입니다.<a href="https://docs.djangoproject.com/ko/3.1/ref/django-admin/">참고</a></li>
      <li><code class="language-plaintext highlighter-rouge">mysite/</code> 디렉토리 내부에는 프로젝트를 위한 실제 python 패키지들이 저장됩니다. 이 디렉토리 내의 이름을 이용하여, (mysite.urls와 같은 식으로) 프로젝트 어디에서나 python 패키지들을 임포트 할 수 있습니다.</li>
      <li><code class="language-plaintext highlighter-rouge">mysite/__init__.py</code>
python으로 하여금 이 디렉토리를 패키지처럼 다루라고 알려주는 용도의 단순한 빈 파일</li>
      <li><code class="language-plaintext highlighter-rouge">mysite/settings.py</code> 현재 Django 프로젝트의 환경 및 구성을 저장합니다. 어떻게 작동하는지 확인하고 싶으면 <a href="https://docs.djangoproject.com/ko/3.1/topics/settings/">여기</a></li>
      <li><code class="language-plaintext highlighter-rouge">mysite/urls.py</code> 현재 Django project의 URL 선언을 저장합니다. Django로 저장된 사이트의 목차라고 할 수 있습니다. URL에 대한 <a href="https://docs.djangoproject.com/ko/3.1/topics/http/urls/">자세한 내용</a></li>
      <li><code class="language-plaintext highlighter-rouge">mysite/asgi.py</code> 프로젝트를 제공하기 위한 ASGI 호환 웹 서버의 진입점 <a href="https://docs.djangoproject.com/ko/3.1/howto/deployment/asgi/">자세히</a></li>
      <li><code class="language-plaintext highlighter-rouge">mysite/wsgi.py</code> 현재 프로젝트를 서비스하기 위한 WSGI 호환 웹 서버의 진입점 <a href="https://docs.djangoproject.com/ko/3.1/howto/deployment/wsgi/">자세히</a></li>
    </ul>
  </li>
</ul>

<h3 id="개발서버">개발서버</h3>

<h4 id="django-프로젝트가-제대로-작동하는지-확인">Django 프로젝트가 제대로 작동하는지 확인</h4>

<p>mysite 디렉토리로 이동하고, 다음 명령어를 입력</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span><span class="w"> </span><span class="nf">python</span><span class="w"> </span><span class="nx">manage.py</span><span class="w"> </span><span class="nx">runserver</span><span class="w">
</span></code></pre></div></div>

<p>서버를 동작시켰으니 http://127.0.0.1:8000/ 을 통해 접속할 수 있습니다.</p>

<blockquote>
  <p>runserver의 자동 변경 기능</p>

  <p>개발 서버는 요청이 돌어올 때마다 자동으로 Python 코드를 다시 불러옵니다. 코드의 변경사항을 반영하기 위해서 굳이 서버를 재가동 하지 않아도 됩니다. 그러나, 파일을 추가하는 등의 몇몇의 동작은 개발 서버가 자동으로 인식하지 못하기 때문에, 이런 상황에서는 서버를 재가동 해야 적용됩니다.</p>
</blockquote>

<h3 id="설문조사-앱-만들기">설문조사 앱 만들기</h3>

<p>앱을 생성하기 위헤 manage.py가 존재하는 디렉토리에서 다음의 명령어를 입력</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span><span class="w"> </span><span class="nf">python</span><span class="w"> </span><span class="nx">manage.py</span><span class="w"> </span><span class="nx">startapp</span><span class="w"> </span><span class="nx">polls</span><span class="w">
</span></code></pre></div></div>

<p>polls라는 디렉토리가 생깁니다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>polls
	__init__.py
	admin.py
	apps.py
	migrations/
		__init__.py
	models.py
	tests.py
	views.py
</code></pre></div></div>

<h3 id="첫번째-뷰-작성하기">첫번째 뷰 작성하기</h3>

<p><code class="language-plaintext highlighter-rouge">polls/view.py</code>를 열고 작성</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>

<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">"Hello, world. You're at the polls index."</span><span class="p">)</span>
</code></pre></div></div>

<p>Django에서 가장 간단한 형태의 뷰입니다. 뷰를 호출하려면 이와 연결된 url이 있어야하는데, 이를 위해 URLconf가 사용됩니다.</p>

<p>polls 디렉토리에서 URLconf를 생성하려면 <code class="language-plaintext highlighter-rouge">urls.py</code>라는 파일을 생성해야 합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">views</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'index'</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div></div>

<p>그런 다음, 최상위 URLconf에서 polls.urls 모듈을 바라보게 설정합니다.</p>

<p><code class="language-plaintext highlighter-rouge">mysite/urls.py</code> 파일을 열고, <code class="language-plaintext highlighter-rouge">django.urls.include</code>를 import하고, urlpatterns 리스트에 include()함수를 다음과 같이 추가합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">path</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'polls/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'polls.urls'</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'admin/'</span><span class="p">,</span> <span class="n">admin</span><span class="p">.</span><span class="n">site</span><span class="p">.</span><span class="n">urls</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">include()</code>함수는 다른 URLconf들을 참조할 수 있도록 도와줍니다. Django가 함수 <code class="language-plaintext highlighter-rouge">include()</code>를 만나게 되면, URL의 그 시점까지 일치하는 부분을 잘라내고, 남은 문자열 부분을 후속처리를 위해 include된 URLconf로 전달합니다.</p>

<p>polls 앱에 그 자체의 URLconf(polls/urls.py)가 존재하는 한, <code class="language-plaintext highlighter-rouge">/polls/</code>, <code class="language-plaintext highlighter-rouge">/fun_polls/</code>, <code class="language-plaintext highlighter-rouge">/content/polls/</code>와 같은 경로, 또는 다른 root 경로에 연결하더라도, 앱은 여전히 잘 동작할 것입니다.</p>

<blockquote>
  <p>include()를 사용하는 경우</p>

  <p>다른 URL 패턴을 포함할 때마다 사용해야합니다. admin.site.urls가 유일한 예외</p>
</blockquote>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span><span class="w"> </span><span class="nf">python</span><span class="w"> </span><span class="nx">manage.py</span><span class="w"> </span><span class="nx">runserver</span><span class="w">
</span></code></pre></div></div>

<p>http://localhost:8000/polls/ -&gt; index 뷰에서 정의한 텍스트가 보임</p>

<p><code class="language-plaintext highlighter-rouge">path()</code>함수에는 2개의 필수 인수인 route와 view, 2개의 선택 가능한 인수 kwargs, name까지 모두 4개의 인수가 전달되었습니다.</p>

<h3 id="path-인수-route">path() 인수: route</h3>

<p>route는 URL 패턴을 가진 문자열입니다. 요청이 처리될 때, DJango는 urlpatterns의 첫 번째 패턴부터 시작하여, 일치하는 패턴을 찾을 때까지 요청된 URL을 각 패턴과 리스트의 순서대로 비교합니다.</p>

<p>패턴들은 GET이나 POST의 매개변수들, 혹은 도메인 이름을 검색하지 않습니다. 예를 들어 http://www.example.com/myapp/이 요청된 경우, URLconf는 오직 myapp/부분만 바라봅니다. http://www.example.com/myapp/?app=3 같은 요청에도, URLconf는 역시 myapp/부분만 신경씁니다.</p>

<hr />

<h3 id="path-인수-view">path() 인수: view</h3>

<p>Django에서 일치하는 패턴을 찾으면, HttpRequest 객체를 첫번째 인수로 하고, 경로로부터 캡쳐된(가져온 값을 말하는 건가?) 값을 키워드 인수로하여 특정 view 함수를 호출합니다.</p>

<hr />

<h3 id="path-인수-kwargs">path() 인수: kwargs</h3>

<p>임의의 키워드 인수들은 목표한 view에 dict 형으로 전달됩니다. 그러나 튜토리얼에서는 사용하지 않음</p>

<hr />

<h3 id="path-인수-name">path() 인수: name</h3>

<p>URL에 이름을 지으면, 템플릿을 포함한 Django 어디에서나 명확하게 참조할 수 있습니다. 이 기능을 이용하면, 단 하나의 파일만 수정해도 project 내의 모든 URL패턴을 바꿀 수 있도록 도와줍니다.</p>
:ET