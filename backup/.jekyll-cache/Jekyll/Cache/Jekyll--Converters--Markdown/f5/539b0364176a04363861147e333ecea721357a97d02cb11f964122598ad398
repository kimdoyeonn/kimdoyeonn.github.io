I".<ul>
  <li>
    <p>참고: <a href="https://tutorial.djangogirls.org/ko/extend_your_application/">장고걸스</a></p>
  </li>
  <li>지금까지 웹 사이트 제작단계를 모두 마쳤습니다. model, url, view, template을 만드는 방법을 알게 되었고 웹사이트를 꾸미는 방법도 알게 되었어요!</li>
  <li>이제 블로그 게시글이 각 페이지마다 보이게 만들어 봅시다!</li>
  <li>이미 앞에서 <code class="language-plaintext highlighter-rouge">Post</code>모델은 만들었으니 <code class="language-plaintext highlighter-rouge">models.py</code>에 새로 추가할 내용은 없어요</li>
</ul>

<h3 id="post에-템플릿-링크-만들기">Post에 템플릿 링크 만들기</h3>

<p><code class="language-plaintext highlighter-rouge">blog/templates/blog/post_list.html</code>파일에 링크를 추가한다. (제목부분)</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;h1&gt;&lt;a</span> <span class="na">href=</span><span class="s">"{% url 'post_detail' pk=post.pk %}"</span><span class="nt">&gt;</span>{{ post.title }}<span class="nt">&lt;/a&gt;&lt;/h1&gt;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">{% url 'post_detail' pk=post.pk %}</code>에서 <code class="language-plaintext highlighter-rouge">{% %}</code>는 장고 탬플릿 태그를 말합니다.</p>

<p><code class="language-plaintext highlighter-rouge">blog.views.post_detail</code>는 <code class="language-plaintext highlighter-rouge">post_detail</code> view의 경로입니다. 여기서 <code class="language-plaintext highlighter-rouge">blog</code>는 응용프로그램의 이름이고, <code class="language-plaintext highlighter-rouge">views</code>는 <code class="language-plaintext highlighter-rouge">views.py</code> 파일 명, <code class="language-plaintext highlighter-rouge">post_detail</code>은 view의 이름입니다.</p>

<p><code class="language-plaintext highlighter-rouge">pk = post.pk</code>에서 <code class="language-plaintext highlighter-rouge">pk</code>는 데이터베이스의 각 레코드를 식별하는 기본키 (<code class="language-plaintext highlighter-rouge">Primary Key</code> )의 줄임말 입니다. Post 모델에서 기본 키를 지정하지 않았기 때문에 장고는 <code class="language-plaintext highlighter-rouge">pk</code>라는 필드를 추가해 새로운 게시글이 추가 될 때마다 그 값이 1,2,3,,, 으로 증가하게 됩니다. Post 객체의 다른 필드 (제목, 작성자 등)에 엑세스하는 것과 같은 방식으로 post.pk를 작성하여 기본 키에 엑세스 합니다. <code class="language-plaintext highlighter-rouge">post.pk</code>를 써서 기본키에 접근할 수 있고 같은 방법으로 다른 필드 (<code class="language-plaintext highlighter-rouge">title</code>, <code class="language-plaintext highlighter-rouge">auther</code>)에도 접근할 수 있다. (? 앞 문장이랑 같은 말?)</p>

<ul>
  <li>이대로 실행을 할 경우 <code class="language-plaintext highlighter-rouge">post_detail</code> view를 만들지 않았기 때문에 오류 메세지가 나옵니다.</li>
</ul>

<h3 id="post-상세-페이지-url-만들기">Post 상세 페이지 URL 만들기</h3>

<p><code class="language-plaintext highlighter-rouge">blog/urls.py</code> 파일에 URL을 만들어 장고가 <code class="language-plaintext highlighter-rouge">post_detail</code> view로 보내 게시글이 보일 수 있게 해봅시다. 파일 안에 <code class="language-plaintext highlighter-rouge">urlpatterns</code> 안에 아래 코드를 추가해준다. <code class="language-plaintext highlighter-rouge">views.post_detail</code>이라는 뷰를 <code class="language-plaintext highlighter-rouge">post_detail</code>이라 이름붙이도록 하는 코드, 이는 장고가 <code class="language-plaintext highlighter-rouge">post_detail</code>이라는 이름을 해석할 떄, <code class="language-plaintext highlighter-rouge">post/views.py</code> 파일 내부의 <code class="language-plaintext highlighter-rouge">post_detail</code>이라는 뷰 함수로 이해할 수 있도록 해준다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">path</span><span class="p">(</span><span class="s">'post/&lt;int:pk&gt;/'</span><span class="p">,</span> <span class="n">views</span><span class="p">.</span><span class="n">post_detail</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'post_detail'</span><span class="p">)</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">post/&lt;int:pk&gt;/</code>는 URL 패턴을 나타낸다.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">post/</code>는 URL이 post 문자를 포함해야한다는 것을 말합니다.</li>
  <li><code class="language-plaintext highlighter-rouge">&lt;int:pk&gt;</code>: 장고가 정수 값을 기대하고 이를 <code class="language-plaintext highlighter-rouge">pk</code>라는 변수로 뷰로 전송한다는 것을 의미함</li>
  <li><code class="language-plaintext highlighter-rouge">/</code>는 다음에 /가 한 번 더 와야 한다는 의미</li>
</ul>

<p>브라우저에 <code class="language-plaintext highlighter-rouge">http://127.0.0.1:8000/post/5/</code>라고 입력하면 장고는 <code class="language-plaintext highlighter-rouge">post_detail</code> 뷰를 찾아 매개변수 <code class="language-plaintext highlighter-rouge">pk</code>가 <code class="language-plaintext highlighter-rouge">5</code>인 값을 찾고 뷰로 전달합니다.</p>

<ul>
  <li>이대로 실행할 경우 뷰가 없기 때문에 에러가 남!</li>
</ul>

<h3 id="post-상세-페이지-내-뷰-추가하기">Post 상세 페이지 내 뷰 추가하기</h3>

<p><code class="language-plaintext highlighter-rouge">blog/views.py</code>에 매개변수 <code class="language-plaintext highlighter-rouge">pk</code>를 포함하는 함수를 추가해봅시다. <code class="language-plaintext highlighter-rouge">def post_detail(request, pk):</code>라고 정의합니다. urls(<code class="language-plaintext highlighter-rouge">pk</code>)와 동일하게 이름을 사용해야 합니다. 변수를 생략할 경우에도 오류 발생</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Post</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span> <span class="c1"># 블로그 게시물 한 개만 볼 경우 쿼리셋
</span></code></pre></div></div>

<p>만약 해당 <code class="language-plaintext highlighter-rouge">primary key( pk )</code>의 <code class="language-plaintext highlighter-rouge">Post</code>를 찾지 못하면 오류가 날 거에요 장고에서는 이를 해결하기 위해 <code class="language-plaintext highlighter-rouge">get_object_or_404</code>라는 기능을 제공해요 <code class="language-plaintext highlighter-rouge">pk</code>에 해당하는 <code class="language-plaintext highlighter-rouge">Post</code>가 없을 경우 <code class="language-plaintext highlighter-rouge">404</code>페이지를 보여주는 기능이에요 이 페이지는 원하는 대로 꾸미는 것도 가능해요</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">get_object_or_404</span>
<span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">timezone</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Post</span>

<span class="k">def</span> <span class="nf">post_list</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">posts</span> <span class="o">=</span> <span class="n">Post</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">filter</span><span class="p">(</span><span class="n">published_date__lte</span><span class="o">=</span><span class="n">timezone</span><span class="p">.</span><span class="n">now</span><span class="p">()).</span><span class="n">order_by</span><span class="p">(</span><span class="s">'published_date'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'blog/post_list.html'</span><span class="p">,</span> <span class="p">{</span><span class="s">'posts'</span><span class="p">:</span><span class="n">posts</span><span class="p">})</span>

<span class="k">def</span> <span class="nf">post_detail</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
    <span class="n">post</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Post</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'blog/post_detail.html'</span><span class="p">,</span> <span class="p">{</span><span class="s">'post'</span><span class="p">:</span> <span class="n">Post</span><span class="p">})</span>
</code></pre></div></div>

<ul>
  <li>메인 페이지는 실행되지만 게시글의 제목을 클릭할 경우 템플릿이 없기 때문에 오류남!</li>
</ul>

<h3 id="post-상세-페이지-템플릿-만들기">Post 상세 페이지 템플릿 만들기</h3>

<p><code class="language-plaintext highlighter-rouge">blog/templates/blog</code> 디렉터리 안에 <code class="language-plaintext highlighter-rouge">post_detail,html</code>파일을 생성하고 아래의 코드를 작성해준다.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% extends 'blog/base.html' %}
{% block content %}
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">'post'</span><span class="nt">&gt;</span>
        {% if post.published_date %}
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">'date'</span><span class="nt">&gt;</span>
                {{ post.published_date }}
            <span class="nt">&lt;/div&gt;</span>
        {% endif %}
        <span class="nt">&lt;h1&gt;</span>{{ post.title }}<span class="nt">&lt;/h1&gt;</span>
        <span class="nt">&lt;p&gt;</span>{{ post.text|linebreaksbr }}<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
{% endblock %}
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">base.html</code>을 다시 한 번 확장 한 것이다. <code class="language-plaintext highlighter-rouge">content</code> 블록에서 블로그 글의 게시일, 제목, 내용을 보이게 만들었다.</p>

<p>가장 중요한 부분은 <code class="language-plaintext highlighter-rouge">{% if ... %}...{% endif %}</code>라는 템플릿 태그인데, 내용이 있는지 확인할 때 사용한다. (<code class="language-plaintext highlighter-rouge">post</code>의 <code class="language-plaintext highlighter-rouge">published_date</code>가 있는지)</p>

<ul>
  <li>이제 실행되는 것을 확인할 수 있다! pythonanywhere로 보내서 배포해보자!</li>
</ul>

:ET